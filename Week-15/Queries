1.
SELECT * FROM ITEMS
WHERE WEIGHT = (SELECT MIN(WEIGHT) FROM ITEMS);



2.
SELECT * FROM WAREHOUSES
JOIN CITIES ON WAREHOUSES.CITY_ID = CITIES.CITY_ID
WHERE CITIES.CITY = 'Pune';


3.
SELECT ITEMS.* FROM ITEMS
JOIN ORDER_ITEMS ON ITEMS.ITEMNO = ORDER_ITEMS.ITEMNO
JOIN ORDERS ON ORDER_ITEMS.ONO = ORDERS.ONO
JOIN CUSTOMER ON ORDERS.CNO = CUSTOMER.CNO
WHERE CUSTOMER.CNAME = 'Mr. Patil';

4.
SELECT WAREHOUSES.* FROM WAREHOUSES
JOIN (
    SELECT WID, COUNT(*) as store_count
    FROM STORES
    GROUP BY WID
) AS STORE_COUNTS ON WAREHOUSES.WID = STORE_COUNTS.WID
WHERE STORE_COUNTS.store_count = (
    SELECT MAX(store_count) FROM (
        SELECT COUNT(*) as store_count
        FROM STORES
        GROUP BY WID
    ) AS MAX_STORE_COUNT
);



5.
SELECT ITEMS.* FROM ITEMS
JOIN (
    SELECT ITEMNO, SUM(ordered_quantity) as total_ordered
    FROM ORDER_ITEMS
    GROUP BY ITEMNO
) AS ITEM_COUNTS ON ITEMS.ITEMNO = ITEM_COUNTS.ITEMNO
WHERE ITEM_COUNTS.total_ordered = (
    SELECT MIN(total_ordered) FROM (
        SELECT SUM(ordered_quantity) as total_ordered
        FROM ORDER_ITEMS
        GROUP BY ITEMNO
    ) AS MIN_ORDER_COUNT
);


6.
SELECT CUSTOMER.CNO, CUSTOMER.CNAME, ORDERS.ONO, ORDERS.ODATE, ITEMS.ITEMNO, ITEMS.DESCRIPTION, ORDER_ITEMS.ordered_quantity
FROM CUSTOMER
JOIN ORDERS ON CUSTOMER.CNO = ORDERS.CNO
JOIN ORDER_ITEMS ON ORDERS.ONO = ORDER_ITEMS.ONO
JOIN ITEMS ON ORDER_ITEMS.ITEMNO = ITEMS.ITEMNO
ORDER BY CUSTOMER.CNO, ORDERS.ONO;
